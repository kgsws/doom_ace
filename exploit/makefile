program = nhax
OBJ0 = ldr0.o
OBJ1 = ldr1.o
CC=gcc -m32 -nostdlib
CFLAGS=${OPT}

build: clean ${program}.wad

clean:
	rm -f *.o ${program}.*

${program}.l0: ${OBJ0}
	${CC} ${OBJ0} -o ${program}.l0 -Wl,--section-start=.text=0x00034615

${program}.l1: ${OBJ1}
	${CC} ${OBJ1} -o ${program}.l1 -Wl,--section-start=.text=0x0003A1E0

${program}.wad: ${program}.l0 ${program}.l1
	objcopy -O binary --only-section=.text ${program}.l0 ${program}.b0
	objcopy -O binary --only-section=.text ${program}.l1 ${program}.b1
	./wadgen.py nhax.b0 nhax.b1 nhax.wad
